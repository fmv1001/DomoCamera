\apendice{Documentación de usuario}

\section{Introducción}

En esta sección vamos a detallar los requisitos necesarios para la instalación y uso del sistema, así como el manual de cómo realizar dicha instalación. También se desarrollará un manual de uso. Todo ello enfocado al usuario final.

\section{Requisitos de usuarios}

\begin{itemize}
\item
	Dispositivo Android con una versión igual o superior a Android Jelly Bean o Android 4.1, para el uso de la aplicación.
\item
	Dispositivo de bajo consumo Raspberry Pi (recomendado) o PC con conexión a Internet, y con Python 3 instalado, para albergar el servidor.
\item
	Es necesario que el dispositivo Android y el dispositivo que vaya a ejecutar el servidor estén conectados a la misma WIFI.
\end{itemize}

\section{Instalación}

Para realizar la instalación del sistema, deberemos realizar dos instalaciones por separado, el servidor y la aplicación. Primero realizaremos la instalación del servidor ya que requiere algo más de tiempo.

\subsubsection{Instalación del servidor}

Esta instalación del servidor se realizará en un dispositivo de bajo consumo como es la Raspberry Pi, aunque si no se dispone de un dispositivo de estas características se puede saltar al paso \ref{paso10} y realizar la instalación en el PC.\\

\textbf{Requisitos}

\begin{itemize}
\item
	Raspberry Pi
\item
	Tarjeta SD de al menos 8 GB, ya que el sistema ocupa 4 GB de ellos.
\item
	Un PC con conexión a internet.
\item \label{piperifs}
	Un Monitor, ratón y teclado para usar la Raspberry Pi, nos vale cualquiera que tenga USB.
\end{itemize}

\textbf{Preparación de la Raspberry e instalación del servidor}\\

\begin{enumerate}
\item
	Insertamos la tarjeta SD en el PC.
\item
	Elegimos y descargamos el sistema operativo que queremos instalar en formato iso.
	Se recomienda el sistema operativo oficial, ya que es el sistema con el que se hacen las pruebas y para el que está diseñado. Lo encontramos en la página oficial, clic \href{https://www.raspberrypi.org/software/operating-systems/#raspberry-pi-os-32-bit}{aquí}.
	Pero también se pueden instalar otros sistemas si así se desea, aquí \cite{pios}.
	\imagen{raspdownload}{Página de descarga de Rasberry Pi OS.}
\item
	Una vez descargado el sistema operativo necesitamos una herramienta para instalar el sistema operativo en formato iso en la tarjeta SD.
	Se recomienda el uso de Raspberry Pi Imager, que podemos encontrarlo \href{https://www.raspberrypi.org/software/}{aquí}.
\item
	Cuando la herramienta este instalada, la abrimos y elegimos el archivo iso y el dispositivo de almacenamiento en el que queremos instalarlo (tarjeta SD).
	Pinchamos en \textit{write}.
\imagen{raspdownload1}{Herramienta Raspberry Pi Imager.}
\item
	Esperamos a que concluya el proceso y ya tenemos la tarjeta preparada.
\item
	Después de preparar la tarjeta la introducimos en el hueco dispuesto para ello de la Raspberry Pi. La conectamos a la corriente y a los periféricos necesarios ya mencionados en \ref{piperifs}.
\item
	Una vez instalado el sistema operativo siguiendo el instalador abrimos un terminal y ejecutamos el siguiente comando:\\
	\textit{python3 --version}\\
	Si el mensaje mostrado es \textit{Python X.X.X}, ya está instalado, pasar al siguiente paso.\\
	Si no ejecutamos el siguiente comando y esperamos a su instalación.
	
	\textit{sudo apt install python 3}
\item
	Cuando acabe la instalación ya tenemos la Raspberry preparada para ejecutar el servidor.
\item
	Ahora procedemos a descargar los archivos del servidor, que podremos descargarlos directamente desde Raspberry Pi en el \href{https://github.com/fmv1001/DomoCamera}{repositorio} o desde el PC y mediante un USB lo descargamos y lo pasamos a la Raspberry Pi.
\item
	Cuando tengamos los archivos del repositorio, sólo necesitaremos la carpeta \textit{Server}, los demás archivos pueden ser borrados. \label{paso10}
\item
	Después abrimos un terminal y nos colocamos dentro de la carpeta \textit{Server/logic}.
\item
	Es posible que haya que instalar las dependencias, OpenCV y SQLAlchemy, para python. Para ello ejecutamos en el terminal:\\
	\textit{pip3 install opencv-python}\\
	\textit{pip3 install SQLAlchemy}
\item
	Por último ejecutamos en el terminal el archivo \textit{MainServer.py}, y ya tendremos el servidor en funcionamiento. Para ello ejecutamos el siguiente comando:\\
	\textit{python3 MainServer.py}\\

\end{enumerate}

\subsubsection{Instalación de la app}

\begin{itemize}
\item
	En primero lugar descargamos los archivos, que podremos descargarlos directamente desde el dispositivo Android en el \href{https://github.com/fmv1001/DomoCamera}{repositorio} o desde el PC y mediante un USB lo descargamos y lo pasamos al smartphone.
	Este archivo que queremos es el archivo APK que se encuentra en la carpeta \textit{/AndroidApp/app/release/}.
\item
	Una vez descragado, lo debemos abrir en el dispositivo Android.
	Para ello nos dirigimos al almacenamiento del dispositivo donde hayamos guardado el archivo y lo abrimos.
\item
	Recibiremos un cuadro de diálogo (figura \ref{fig:appinstall}) que nos pregunta si queremos instalar la aplicación, debemos indicar \textit{instalar}.
\imagengrande{0.35}{appinstall}{Instalación de la aplicación desde un archivo APK.}
\item
	Es posible que recibamos un aviso como el que se muestra a continuación (figura \ref{fig:appinstall1}).
\imagengrande{0.35}{appinstall1}{Aviso en la instalación de la aplicación desde un archivo APK.}
	Debemos pulsar en \textit{Instalar de todas formas}.
\end{itemize}



\section{Manual del usuario}

En este manual se va a proceder a explicar cómo hacer uso de la aplicación.
En este enlace (\href{https://youtu.be/txAF8uAJ6B0}{Vídeo manual de usuario}), podremos ver este manual en formato vídeo.

\subsubsection{Conectarse al servidor}

Para conectarnos al servidor debemos navegar hasta la pantalla \textit{Settings}.

\begin{itemize}
\item
	Desde la pantalla principal abriremos el menú de navegación en el borde superior izquierdo (figura \ref{fig:manualuse0}).
	\imagengrande{0.35}{manualuse0}{Pantalla principal de la aplicación.}
\item
	Desde el menú de navegación pulsaremos \textit{Settings} para ir a la pantalla de \textit{Settings} (figura \ref{fig:manualuse01}).
	\imagengrande{0.35}{manualuse01}{Menú de navegación de la aplicación.}
\item
	Una vez en la pantalla de \textit{Settings} procederemos a rellenar los campos con la Ip del servidor y el puerto de escucha (este es el 8888 por defecto) (figura \ref{fig:manualuse1}).
	\imagengrande{0.35}{manualuse1}{Pantalla \textit{Settings} de la aplicación.}
\item
	Por último pulsamos en \textit{Conectarse con el servidor}.
\end{itemize}

\subsubsection{Añadir cámara}

Para añadir una cámara debemos situarnos en la pantalla principal y abrir el menú desplegable.

\begin{itemize}
\item
	Desde la pantalla principal abriremos el menú de desplegable en el borde superior derecho (figura \ref{fig:manualuse20}).
	\imagengrande{0.35}{manualuse20}{Pantalla principal de la aplicación.}
\item
	Desde el menú de desplegable pulsaremos \textit{Add camera} y nos saltará un cuadro de diálogo (figs. \ref{fig:manualuse21} y \ref{fig:manualuse3}).
	\imagengrande{0.35}{manualuse21}{Pantalla principal con menú desplegable abierto.}
	\imagengrande{0.35}{manualuse3}{Diálogo para añadir cámara en la aplicación.}
\item
	Una vez en cuadro de diálogo, rellenamos los campos exigidos y hacemos clic en aceptar (figura \ref{fig:manualuse4}).
	\imagengrande{0.35}{manualuse4}{Diálogo para añadir cámara en la aplicación.}
\item
	Se ha mostrado en la pantalla principal el botón de la cámara introducida (figura \ref{fig:manualuse5}).
	\imagengrande{0.35}{manualuse5}{Pantalla principal con cámara añadida en la aplicación.}
\end{itemize}

\subsubsection{Ver cámara}

Para ver una cámara debemos situarnos en la pantalla principal y debe haber alguna ya añadida anteriormente.

\begin{itemize}
\item
	Desde la pantalla principal pulsaremos el botón de la cámara que deseemos ver, están designadas con su nombre (figura \ref{fig:manualuse5a}).
	\imagengrande{0.35}{manualuse5a}{Pantalla principal con cámara añadida en la aplicación.}
\item
	Se nos abrirá una pantalla donde se muestra la imagen en teimpo real (figura \ref{fig:manualuse6}).
	\imagengrande{0.35}{manualuse6}{Pantalla de visualización de cámara.}
\item
	Si lo deseamos podemos tumbar el dispositivo para ver una imagen mas amplia (figura \ref{fig:manualuse7}).
	\imagengrande{0.9}{manualuse7}{Pantalla de visualización de cámara tumbada.}
\end{itemize}

\subsubsection{Grabar de la cámara}

Para grabar una pequeña secuencia de vídeo debemos encontrarnos en pantalla de visualización de una de las cámaras.

\begin{itemize}
\item
	Una vez en la pantalla de visualización, pinchamos en el botón gris y rojo (figura \ref{fig:manualuse61}).
	\imagengrande{0.35}{manualuse61}{Pantalla de visualización de cámara.}
\item
	Se grabará un vídeo que podremos ver en el almacenamiento del dispositivo.
\end{itemize}

\subsubsection{Eliminar cámara}

Para eliminar una cámara debemos situarnos en la pantalla principal y abrir el menú desplegable.

\begin{itemize}
\item
	Desde la pantalla principal abriremos el menú de desplegable en el borde superior derecho (figura \ref{fig:manualuse20a}).
	\imagengrande{0.35}{manualuse20a}{Pantalla principal de la aplicación.}
\item
	Desde el menú de desplegable pulsaremos \textit{Delete camera} y nos saltará un cuadro de diálogo (figura \ref{fig:manualuse80}).
	\imagengrande{0.35}{manualuse80}{Pantalla principal con menú desplegable abierto.}
\item
	Una vez en cuadro de diálogo, escogemos la cámara para eliminar y hacemos clic en aceptar (figura \ref{fig:manualuse81}).
	\imagengrande{0.35}{manualuse81}{Diálogo para eliminar cámara en la aplicación.}
\item
	Se ha eliminado de la pantalla principal el botón de la cámara (figura \ref{fig:manualuse}).
	\imagengrande{0.35}{manualuse}{Pantalla principal con cámara eliminada en la aplicación.}
\end{itemize}

\subsubsection{Desconectarse del servidor}

Para desconectarse del servidor debemos situarnos en la pantalla principal y abrir el menú desplegable.

\begin{itemize}
\item
	Desde la pantalla principal abriremos el menú de desplegable en el borde superior derecho (figura \ref{fig:manualuse20b}).
	\imagengrande{0.35}{manualuse20b}{Pantalla principal de la aplicación.}
\item
	Desde el menú de desplegable pulsaremos \textit{Disconnect} (figura \ref{fig:manualuse90}).
	\imagengrande{0.35}{manualuse90}{Pantalla principal con menú desplegable abierto.}
\end{itemize}

\subsubsection{Parar servidor}

Para parar el servidor debemos situarnos en la pantalla principal y abrir el menú desplegable.

\begin{itemize}
\item
	Desde la pantalla principal abriremos el menú de desplegable en el borde superior derecho (figura \ref{fig:manualuse20c}).
	\imagengrande{0.35}{manualuse20c}{Pantalla principal de la aplicación.}
\item
	Desde el menú de desplegable pulsaremos \textit{Stop Server} (figura \ref{fig:manualuse91}).
	\imagengrande{0.35}{manualuse91}{Pantalla principal con menú desplegable abierto.}
\end{itemize}

\subsubsection{Visualizar log}

Para visualizar el log debemos navegar hasta la pantalla \textit{Log}.

\begin{itemize}
\item
	Desde la pantalla principal abriremos el menú de navegación en el borde superior izquierdo.
	\imagengrande{0.35}{manualuse0a}{Pantalla principal de la aplicación.}
\item
	Desde el menú de navegación pulsaremos \textit{Log} para ir a la pantalla de \textit{Log} (figura \ref{fig:manualuse02}).
	\imagengrande{0.35}{manualuse02}{Menú de navegación de la aplicación.}
\item
	Una vez en la pantalla de \textit{Log} podemos ver el log y hacer scroll sobre él (figura \ref{fig:manualuselog}).
	\imagengrande{0.35}{manualuselog}{Pantalla \textit{Log} de la aplicación.}
\end{itemize}


